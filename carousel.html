<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrusel de Imágenes</title>
    <!-- Bootstrap CSS y Select2 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        body {
            background-color: #f8f9fa;
            padding: 20px;
        }
        .carousel-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        .carousel-inner {
            border-radius: 8px;
            overflow: hidden;
        }
        .carousel-item img {
            width: 100%;
            height: 500px;
            object-fit: contain;
            background-color: black;
        }
        .carousel-caption {
            background: rgba(0,0,0,0.7);
            border-radius: 15px;
            padding: 15px;
        }
        .carousel-control-prev, .carousel-control-next {
            width: 5%;
            opacity: 0.8;
        }
        .carousel-indicators {
            bottom: -50px;
        }
        .carousel-indicators button {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin: 0 5px;
        }
        .filter-container {
            max-width: 800px;
            margin: 0 auto 20px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .filter-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        .filter-col {
            flex: 1;
        }
        .select2-container {
            width: 100% !important;
        }
        .hidden {
            display: none !important;
        }
        .filter-label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #495057;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Filtros -->
        <div class="filter-container">
            <h5 class="mb-3">Filtros de Búsqueda</h5>
            <div class="filter-row">
                <div class="filter-col">
                    <label class="filter-label" for="marcaFilter">Marca</label>
                    <select id="marcaFilter" class="form-select">
                        <option value="">Todas las marcas</option>
                        <option value="coca zero">Coca Zero</option>
                        <option value="coca sin azucar">Coca Sin Azúcar</option>
                        <option value="pepsi">Pepsi</option>
                        <option value="coca light">Coca Light</option>
                        <option value="rojas">Rojas</option>
                        <option value="verdes">Verdes</option>
                        <option value="azules">Azules</option>
                    </select>
                </div>
                <div class="filter-col">
                    <label class="filter-label" for="mesFilter">Mes</label>
                    <select id="mesFilter" class="form-select">
                        <option value="">Todos los meses</option>
                        <option value="enero">Enero</option>
                        <option value="febrero">Febrero</option>
                        <option value="marzo">Marzo</option>
                    </select>
                </div>
                <div class="filter-col">
                    <label class="filter-label" for="anuncianteFilter">Anunciante</label>
                    <select id="anuncianteFilter" class="form-select">
                        <option value="">Todos los anunciantes</option>
                        <option value="coca">Coca</option>
                        <option value="pepsi">Pepsi</option>
                        <option value="sabritas">Sabritas</option>
                        <option value="ruffles">Ruffles</option>
                    </select>
                </div>
                <div class="filter-col">
                    <label class="filter-label" for="categoriaFilter">Categoría</label>
                    <select id="categoriaFilter" class="form-select">
                        <option value="">Todas las categorías</option>
                        <option value="refrescos">Refrescos</option>
                        <option value="papas">Papas</option>
                    </select>
                </div>
            </div>
            <button id="clearFilters" class="btn btn-outline-secondary">Limpiar Filtros</button>
        </div>

        <div class="carousel-container">
            <div id="imageCarousel" class="carousel slide" data-bs-ride="carousel">
                <!-- Indicadores se generarán dinámicamente -->
                <div class="carousel-indicators"></div>

                <!-- Slides -->
                <div class="carousel-inner">
                    <div class="carousel-item active" data-frame="frame_1347" data-marca="coca zero" data-mes="enero" data-anunciante="coca" data-categoria="refrescos">
                        <img src="https://raw.githubusercontent.com/expandaventures/imagenes_prueba_public/master/frame_1347.jpg" class="d-block w-100" alt="Frame 1347">
                        <div class="carousel-caption">
                            <p>Frame 1347 - Coca Zero</p>
                        </div>
                    </div>
                    <div class="carousel-item" data-frame="frame_1648" data-marca="coca sin azucar" data-mes="febrero" data-anunciante="coca" data-categoria="refrescos">
                        <img src="https://raw.githubusercontent.com/expandaventures/imagenes_prueba_public/master/frame_1648.jpg" class="d-block w-100" alt="Frame 1648">
                        <div class="carousel-caption">
                            <p>Frame 1648 - Coca Sin Azúcar</p>
                        </div>
                    </div>
                    <div class="carousel-item" data-frame="frame_19337" data-marca="pepsi" data-mes="enero" data-anunciante="pepsi" data-categoria="refrescos">
                        <img src="https://raw.githubusercontent.com/expandaventures/imagenes_prueba_public/master/frame_19337.jpg" class="d-block w-100" alt="Frame 19337">
                        <div class="carousel-caption">
                            <p>Frame 19337 - Pepsi</p>
                        </div>
                    </div>
                    <div class="carousel-item" data-frame="frame_19598" data-marca="coca sin azucar" data-mes="febrero" data-anunciante="coca" data-categoria="refrescos">
                        <img src="https://raw.githubusercontent.com/expandaventures/imagenes_prueba_public/master/frame_19598.jpg" class="d-block w-100" alt="Frame 19598">
                        <div class="carousel-caption">
                            <p>Frame 19598 - Coca Sin Azúcar</p>
                        </div>
                    </div>
                    <div class="carousel-item" data-frame="frame_22595" data-marca="coca light" data-mes="enero" data-anunciante="coca" data-categoria="refrescos">
                        <img src="https://raw.githubusercontent.com/expandaventures/imagenes_prueba_public/master/frame_22595.jpg" class="d-block w-100" alt="Frame 22595">
                        <div class="carousel-caption">
                            <p>Frame 22595 - Coca Light</p>
                        </div>
                    </div>
                    <div class="carousel-item" data-frame="frame_2970" data-marca="rojas" data-mes="febrero" data-anunciante="sabritas" data-categoria="papas">
                        <img src="https://raw.githubusercontent.com/expandaventures/imagenes_prueba_public/master/frame_2970.jpg" class="d-block w-100" alt="Frame 2970">
                        <div class="carousel-caption">
                            <p>Frame 2970 - Sabritas Rojas</p>
                        </div>
                    </div>
                    <div class="carousel-item" data-frame="frame_5231" data-marca="verdes" data-mes="marzo" data-anunciante="sabritas" data-categoria="papas">
                        <img src="https://raw.githubusercontent.com/expandaventures/imagenes_prueba_public/master/frame_5231.jpg" class="d-block w-100" alt="Frame 5231">
                        <div class="carousel-caption">
                            <p>Frame 5231 - Sabritas Verdes</p>
                        </div>
                    </div>
                    <div class="carousel-item" data-frame="frame_5984" data-marca="azules" data-mes="marzo" data-anunciante="ruffles" data-categoria="papas">
                        <img src="https://raw.githubusercontent.com/expandaventures/imagenes_prueba_public/master/frame_5984.jpg" class="d-block w-100" alt="Frame 5984">
                        <div class="carousel-caption">
                            <p>Frame 5984 - Ruffles Azules</p>
                        </div>
                    </div>
                </div>

                <!-- Controles -->
                <button class="carousel-control-prev" type="button" data-bs-target="#imageCarousel" data-bs-slide="prev" style="display: none;">
                    <span class="carousel-control-prev-icon"></span>
                    <span class="visually-hidden">Anterior</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#imageCarousel" data-bs-slide="next" style="display: none;">
                    <span class="carousel-control-next-icon"></span>
                    <span class="visually-hidden">Siguiente</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        $(document).ready(function() {
            // Función para actualizar el carrusel basado en los filtros
            function updateCarousel() {
                var marca = $('#marcaFilter').val();
                var mes = $('#mesFilter').val();
                var anunciante = $('#anuncianteFilter').val();
                var categoria = $('#categoriaFilter').val();
                
                var items = $('.carousel-item');
                var indicators = $('.carousel-indicators');
                var prevButton = $('.carousel-control-prev');
                var nextButton = $('.carousel-control-next');
                
                // Limpiar indicadores
                indicators.empty();
                
                // Ocultar todos los items y quitar active
                items.addClass('hidden').removeClass('active');
                
                // Filtrar items
                var visibleItems = items.filter(function() {
                    var matchMarca = !marca || $(this).data('marca') === marca;
                    var matchMes = !mes || $(this).data('mes') === mes;
                    var matchAnunciante = !anunciante || $(this).data('anunciante') === anunciante;
                    var matchCategoria = !categoria || $(this).data('categoria') === categoria;
                    
                    return matchMarca && matchMes && matchAnunciante && matchCategoria;
                });
                
                // Mostrar items filtrados
                if (visibleItems.length > 0) {
                    visibleItems.removeClass('hidden');
                    visibleItems.first().addClass('active');
                    
                    // Mostrar/ocultar flechas según cantidad de items
                    if (visibleItems.length > 1) {
                        prevButton.show();
                        nextButton.show();
                    } else {
                        prevButton.hide();
                        nextButton.hide();
                    }
                    
                    // Crear indicadores para items visibles
                    visibleItems.each(function(index) {
                        indicators.append(`
                            <button type="button" data-bs-target="#imageCarousel" 
                                    data-bs-slide-to="${index}" 
                                    ${index === 0 ? 'class="active"' : ''}>
                            </button>
                        `);
                    });
                } else {
                    // Si no hay resultados, mostrar todos
                    items.removeClass('hidden');
                    items.first().addClass('active');
                    
                    // Mostrar flechas si hay más de un item
                    if (items.length > 1) {
                        prevButton.show();
                        nextButton.show();
                    } else {
                        prevButton.hide();
                        nextButton.hide();
                    }
                    
                    items.each(function(index) {
                        indicators.append(`
                            <button type="button" data-bs-target="#imageCarousel" 
                                    data-bs-slide-to="${index}" 
                                    ${index === 0 ? 'class="active"' : ''}>
                            </button>
                        `);
                    });
                }
                
                // Reiniciar el carrusel
                var carousel = bootstrap.Carousel.getInstance(document.getElementById('imageCarousel'));
                if (carousel) {
                    carousel.dispose();
                }
                new bootstrap.Carousel(document.getElementById('imageCarousel'), {
                    interval: 3000,
                    wrap: true // Esto hace que el carrusel sea cíclico
                });
            }

            // Eventos de cambio en los filtros
            $('.form-select').on('change', updateCarousel);

            // Botón para limpiar filtros
            $('#clearFilters').click(function() {
                $('.form-select').val('');
                updateCarousel();
            });

            // Inicializar el carrusel
            updateCarousel();
        });
    </script>
</body>
</html>
